name: Telegram Message Copier

on:
  schedule:
    - cron: '0 5-19 * * *'  # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π —á–∞—Å —Å 8:00 –¥–æ 22:00 –ø–æ –ú–æ—Å–∫–≤–µ (UTC+3)
  workflow_dispatch:  # –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

jobs:
  copy_messages:
    runs-on: ubuntu-latest
    timeout-minutes: 360  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è workflow 6 —á–∞—Å–æ–≤

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.x

    - name: Install dependencies
      run: |
        pip install -r requirements.txt
        pip install python-telegram-bot  # –î–æ–±–∞–≤–ª—è–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É –º–æ–¥—É–ª—è

    - name: Run telegram message copier
      run: |
        python telegram_message_copier.py

    - name: Save last_message artifact
      if: success()  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è
      uses: actions/upload-artifact@v2
      with:
        name: last_message
        path: last_message.txt

    - name: Send completion emoji
      if: always()  # –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ (—É—Å–ø–µ—Ö –∏–ª–∏ –Ω–µ—É–¥–∞—á–∞)
      run: |
        python -c "from telegram import Bot; bot = Bot(token='7213896068:AAGbXygK7S1Jv3fCwx6n7jGNaHDSH2SgxfQ'); bot.send_message(chat_id='@ImperialSochiRS', text='üëã Workflow –∑–∞–≤–µ—Ä—à–µ–Ω!')"
