name: Copy Telegram Messages

on:
  schedule:
    - cron: "*/30 8-22 * * *"  # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç —Å 8:00 –¥–æ 22:00
  workflow_dispatch:

jobs:
  copy_messages:
    runs-on: ubuntu-latest
    timeout-minutes: 25  # –¢–∞–π–º–∞—É—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.8

    - name: Install dependencies
      run: pip install -r requirements.txt

    - name: Run the script
      run: python telegram_message_copier.py

    - name: Send end message on success
      if: success()
      run: python -c "from telegram import Bot; bot = Bot(token='$TELEGRAM_BOT_TOKEN'); bot.send_message(chat_id='@ImperialSochiRS', text='üëã Workflow –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!')"

    - name: Send end message on failure
      if: failure()
      run: python -c "from telegram import Bot; bot = Bot(token='$TELEGRAM_BOT_TOKEN'); bot.send_message(chat_id='@ImperialSochiRS', text='‚ùå Workflow –∑–∞–≤–µ—Ä—à–µ–Ω —Å –æ—à–∏–±–∫–∞–º–∏!')"
