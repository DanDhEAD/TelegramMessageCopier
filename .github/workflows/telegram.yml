name: Copy Telegram Messages

on:
  schedule:
    - cron: "*/10 8-22 * * *"  # –û–¥–∏–Ω —Ä–∞–∑ —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
    - cron: "*/30 8-22 * * *"  # –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç —Å 8:00 –¥–æ 22:00 –ø–æ –ú–°–ö –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
  workflow_dispatch:

jobs:
  copy_messages:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.8

    - name: Install dependencies
      run: pip install -r requirements.txt

    - name: Run the script
      run: python telegram_message_copier.py

    - name: Send end message on success
      if: success()
      run: python -c "from telegram import Bot; bot = Bot(token='$TELEGRAM_BOT_TOKEN'); bot.send_message(chat_id='@ImperialSochiRS', text='üëã Workflow –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!')"

    - name: Send end message on failure
      if: failure()
      run: python -c "from telegram import Bot; bot = Bot(token='$TELEGRAM_BOT_TOKEN'); bot.send_message(chat_id='@ImperialSochiRS', text='‚ùå Workflow –∑–∞–≤–µ—Ä—à–µ–Ω —Å –æ—à–∏–±–∫–∞–º–∏!')"
